
@{

}
<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>@ViewBag.Title</title>
    @Styles.Render(new string[]
    {
        "~/Content/font-awesome.css",
        "~/Scripts/jeasyui/themes/"+Request.Cookies["theme"].Value+"/easyui.css",
        "~/Scripts/jeasyui/themes/icon.css",
        "~/Scripts/jeasyui/themes/color.css",
        "~/Scripts/kindeditor/themes/default/default.css",
        "~/Scripts/kindeditor/plugins/code/prettify.css",
        "~/Content/Site.css"
    })

    @Scripts.Render(new string[]
    {
        "~/Scripts/jquery-3.3.1.min.js",
        "~/Scripts/jquery.validate.min.js",
        "~/Scripts/moment.min.js",
        "~/Scripts/moment-with-locales.min.js",
        "~/Scripts/jeasyui/jquery.easyui.min.js",
        "~/Scripts/jeasyui/datagrid-detailview.js",
        "~/Scripts/jeasyui/locale/easyui-lang-zh_CN.js",
        "~/Scripts/kindeditor/kindeditor-all.js",
        "~/Scripts/kindeditor/lang/zh-CN.js",
        "~/Scripts/misframework3.js",
        "~/Scripts/fw_plugins/export_datagrid.js"
    })

</head>
<body class="easyui-layout">
    <div data-options="region:'north',title:'',border:false,split:false" style="margin-top:8px;overflow-y:visible;height:110px">
        <div id="cmpDgToolBar" style="overflow: hidden;overflow-y: visible">
            <div style="margin-bottom:5px;height:30px;margin-right:44px;">
                <div id="cmpDgToolBar_Left" style="float:left">
                    @if (ViewBag.HideCommonButtons == null || !ViewBag.HideCommonButtons)
                    {
                        <a id="stdBtnAdd" href="#" onclick="btnAddEvent()" class="easyui-linkbutton" data-options="iconCls:'icon-add',plain:false,disabled:@(ViewBag.DisableBTN_Add!=null && ViewBag.DisableBTN_Add?"true":"false")">增加</a>
                        <a id="stdBtnEdit" href="#" onclick="btnEditEvent()" class="easyui-linkbutton" data-options="iconCls:'icon-edit',plain:false,disabled:@(ViewBag.DisableBTN_Edit!=null && ViewBag.DisableBTN_Edit?"true":"false")">修改</a>
                        if (ViewBag.ShowDeleteButton != null && ViewBag.ShowDeleteButton)
                        {
                            <a id="stdBtnDelete" href="#" onclick="btnRemoveEvent()" class="easyui-linkbutton" data-options="iconCls:'icon-remove',plain:false,disabled:@(ViewBag.DisableBTN_Delete != null && ViewBag.DisableBTN_Delete ? "true" : "false")">删除</a>
                        }

                        if (ViewBag.ShowChangeStateButton != null && ViewBag.ShowChangeStateButton)
                        {
                            <span class="datagrid-btn-separator" style="vertical-align: middle;display:inline-block;float:none"></span>
                            <a href="#" onclick="btnDisableEvent()" class="easyui-linkbutton" data-options="iconCls:'icon-no',plain:false,disabled:@(ViewBag.DisableBTN_Disable != null && ViewBag.DisableBTN_Disable ? "true" : "false")">停用</a>
                            <a href="#" onclick="btnEnableEvent()" class="easyui-linkbutton" data-options="iconCls:'icon-ok',plain:false,disabled:@(ViewBag.DisableBTN_Enable != null && ViewBag.DisableBTN_Enable ? "true" : "false")">启用</a>
                        }
                    }
                </div>
                <div id="cmpDgToolBar_Right" style="float:right">
                    <a href="#" style="float:right;margin-right:-30px;" onclick="btnSearchEvent()" class="easyui-linkbutton" data-options="iconCls:'icon-search',plain:false">查询</a>
                    <a href="#" style="float:right;margin-right:10px;" onclick="btnClearEvent()" class="easyui-linkbutton" data-options="iconCls:'icon-search',plain:false">清空</a>
                </div>
            </div>
            <div style="margin-bottom:5px;">
                <div style="width:33%;display:inline-block">
                    <div style="width:30%;height: 29px;line-height: 28px;display:inline-block;text-align:right;">全部库存：</div>
                    <input id="STOCK_WHOLE" name="STOCK_WHOLE" class="easyui-textbox" style="width:67%">
                </div>
                <div style="width:33%;display:inline-block">
                    <div style="width:30%;height: 29px;line-height: 28px;display:inline-block;text-align:right;">单位名称：</div>
                    <select id="COMPANY_ID_NAME" class="easyui-combobox" name="COMPANY_ID_NAME" style="width:67%">
                        <option value=""></option>
                    </select>
                </div>
                <div style="width:33%;display:inline-block">
                    <div style="width:30%;height: 29px;line-height: 28px;display:inline-block;text-align:right;">剩余库存：</div>
                    <input id="STOCK_OVERPLUS" name="STOCK_OVERPLUS" class="easyui-textbox" style="width:67%">
                </div>
            </div>
            <div style="margin-bottom:5px;">
                <div style="width:33%;display:inline-block">
                    <div style="width:30%;height: 29px;line-height: 28px;display:inline-block;text-align:right;">单位编号：</div>
                    <input id="COMPANY_ID_ID" name="COMPANY_ID_ID" class="easyui-textbox" style="width:67%">
                </div>
                <div style="width:33%;display:inline-block">
                    <div style="width:30%;height: 29px;line-height: 28px;display:inline-block;text-align:right;">录入时间：</div>
                    <input id="INPUT_TIME" name="INPUT_TIME" class="easyui-datebox" style="width:67%">
                </div>
            </div>
        </div>
    </div>
    <div data-options="region:'center',title:'',border:false">
        <table id="cmpDG"></table>
    </div>
    <div id="dialogDic"></div>
    @* 组合查询*@
    @RenderBody()
</body>
</html>
<script>
    $(function () {
        $.ajax({
            type: "get",
            url: 'GetSelect',//访问后台去数据库查询select的选项
            success: function (data) {
                var data2 = eval('(' + data + ')');
                var planType = data2.planType;
                if (planType != null) { //后台传回来的select选项
                    $("#COMPANY_ID_NAME").combobox({
                        valueField: 'DM',
                        textField: 'MC',
                        data: planType
                    });
                }
            },
            error: function () {
                J.alert('Error');
            }
        })
    });
    
    function btnClearEvent() {
        $("#STOCK_WHOLE").textbox('setValue', "");
        $("#COMPANY_ID_ID").textbox('setValue', "");
        $("#STOCK_OVERPLUS").textbox('setValue', "");
        $("#COMPANY_ID_NAME").textbox('setValue', "");
        $("#INPUT_TIME").textbox('setValue', "");
    }

    var params2 = {};
    function btnSearchEvent() {
        var params = {};
        params.STOCK_WHOLE = $("#STOCK_WHOLE").textbox("getValue");
        params.COMPANY_ID_1 = $("#COMPANY_ID_ID").textbox("getValue");
        params.STOCK_OVERPLUS = $("#STOCK_OVERPLUS").textbox("getValue");
        params.COMPANY_ID = $("#COMPANY_ID_NAME").textbox("getValue");
        params.INPUT_TIME = $("#INPUT_TIME").textbox("getValue");
        @if (ViewBag.DateRangeType != null)
        {
        <text>
        params.date_range_type = $("#date_range_type").combobox("getValue");
        params.start_date = $("#start_date").datebox("getValue");
        params.end_date = $("#end_date").datebox("getValue");
        </text>
        }
        console.log("查询条件：" + JSON.stringify(params));
        $('#cmpDG').datagrid("load", params);

        params2.STOCK_WHOLE = $("#STOCK_WHOLE").textbox("getValue");
        params2.COMPANY_ID_1 = $("#COMPANY_ID_ID").textbox("getValue");
        params2.STOCK_OVERPLUS = $("#STOCK_OVERPLUS").textbox("getValue");
        params2.COMPANY_ID = $("#COMPANY_ID_NAME").textbox("getValue");
        params2.INPUT_TIME = $("#INPUT_TIME").textbox("getValue");
    }
    $(function () {
        $('#search').textbox('textbox').keydown(function (e) {
            if (e.which == 13) {
                btnSearchEvent();
                return false;
            }
        });

        $('#cmpDG').datagrid('resize', { height: 430 });
    })
</script>

